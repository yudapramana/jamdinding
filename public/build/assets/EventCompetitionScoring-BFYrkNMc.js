import{z as At,y as p,J as G,I as Dt,K as z,V as Et,A as i,B as o,C as a,O as x,M as d,S as v,G as tt,R as X,aB as mt,U as M,ay as P,a as R,as as ct}from"./AuthUserStore-Du_wEH36.js";import{S as y}from"./sweetalert2.esm.all-9Qm2jZ7z.js";import{_ as Rt}from"./app-D2SkCNoG.js";const Kt={class:"content-header"},Ut={class:"container-fluid"},Ft={class:"d-flex justify-content-between align-items-center"},jt={class:"mb-0 text-muted text-sm"},Ot={key:0,class:"mb-0 mt-1 text-sm text-muted"},Wt={key:0},qt={key:1,class:"text-muted text-sm mt-1"},zt={class:"btn-group"},Jt=["disabled"],Ht={key:0,class:"text-danger text-sm mt-2 mb-0"},Qt={class:"content"},Xt={class:"container-fluid"},Yt={class:"card"},Zt={class:"card-header"},te={class:"form-row"},ee={class:"form-group col-md-6 mb-2"},ae=["disabled"],ne=["label"],se=["value"],ie={key:0,class:"text-muted"},oe={class:"form-group col-md-6 mb-2"},le={class:"mb-1 text-sm"},re=["disabled"],ue={value:"",disabled:""},de={key:0,value:"",disabled:""},me=["label"],ce={disabled:"",class:"opt-contingent-header"},ve=["value"],fe={key:0,class:"text-muted"},ge={key:1,class:"text-muted"},be={key:0,class:"card"},pe={class:"card-header d-flex justify-content-between align-items-center"},_e={key:0,class:"text-muted text-sm"},he={class:"btn-group"},ye=["disabled"],ke={key:0,class:"card-body p-0 table-responsive"},xe={class:"table table-bordered table-hover text-sm mb-0"},we={class:"thead-light"},Se={class:"d-flex flex-column align-items-center"},Me={class:"font-weight-bold"},Ne={class:"text-muted text-xs mt-1"},Ce={class:"badge badge-light border"},Be={class:"d-flex justify-content-between align-items-start"},$e={class:"text-muted text-xs mt-1"},Te={class:"badge badge-light border"},Le={class:"form-row no-gutters"},Ge={class:"col-5 pr-1"},Ie=["disabled","max","onUpdate:modelValue","onInput"],Pe={class:"text-muted text-xs d-block mt-1"},Ve={class:"col-7"},Ae=["disabled","onUpdate:modelValue"],De={class:"bg-light"},Ee={class:"badge badge-primary"},Re={class:"bg-light"},Ke=["colspan"],Ue={class:"badge badge-warning",style:{"font-size":"13px"}},Fe={key:1,class:"card-body"},je={key:0,class:"text-center py-4"},Oe={key:1,class:"text-center py-4 text-muted"},We={class:"card-footer"},qe={class:"d-flex justify-content-between align-items-start flex-wrap"},ze={key:0,class:"alert alert-warning py-2 mb-2",style:{"border-radius":"8px","max-width":"680px"}},Je={class:"d-flex align-items-start"},He={class:"mb-0 mt-1 text-sm"},Qe={class:"btn-group mt-2 mt-sm-0"},Xe=["disabled"],Ye={key:0,class:"fas fa-spinner fa-spin mr-1"},Ze=["disabled"],ta=["disabled"],ea={key:1,class:"alert alert-info",style:{"border-radius":"8px"}},K=3,aa={__name:"EventCompetitionScoring",setup(na){const J=Dt(),vt=At(),F=p(()=>vt.eventData||null),B=p(()=>{var e;return((e=F.value)==null?void 0:e.id)||null}),_=G(String(J.params.id||"")),k=G(String(J.query.event_participant_id||"")),$=G(null),N=p(()=>{var e,t;return!!((t=(e=$.value)==null?void 0:e.event_group)!=null&&t.is_team)}),j=G(!1),O=G(!1),et=G([]),W=G([]),at=e=>{var t,n;return((t=e==null?void 0:e.event_category)==null?void 0:t.full_name)||(e==null?void 0:e.category_name)||((n=e==null?void 0:e.eventCategory)==null?void 0:n.full_name)||"-"},nt=e=>((e==null?void 0:e.contingent)??"").toString().trim()||"-",ft=(e,t,n)=>{var u,c,C;console.log("p"),console.log(e);const l=(t||at(e)||"-").toString().trim(),f=(n||nt(e)).toString().trim();if(N.value)return((e==null?void 0:e.team_name)||(e==null?void 0:e.contingent)||"Tim").toString().trim(),(e==null?void 0:e.member_count)!=null&&`${e.member_count}`,`${e!=null&&e.member_names&&e.member_names.length?`  ${e.member_names.join(", ")}${e!=null&&e.member_count&&e.member_names.length<e.member_count?", ...":""}`:""}`;const r=(((u=e==null?void 0:e.participant)==null?void 0:u.full_name)||(e==null?void 0:e.full_name)||"Peserta").toString().trim(),b=(((c=e==null?void 0:e.participant)==null?void 0:c.nik)||(e==null?void 0:e.nik)||"").toString().trim(),m=((C=e==null?void 0:e.participant)==null?void 0:C.participant_number).toString().trim();return m?`${m} - ${r} (${b})`:`${l} - ${f} - ${r}`},st=p(()=>{var f;const e=W.value||[],t=new Map;for(const r of e){const b=at(r)||"-",m=String((r==null?void 0:r.event_category_id)??((f=r==null?void 0:r.event_category)==null?void 0:f.id)??b);t.has(m)||t.set(m,{id:m,name:b,count:0,contMap:new Map});const u=t.get(m);u.count++;const c=nt(r);u.contMap.has(c)||u.contMap.set(c,{name:c,count:0,items:[]});const C=u.contMap.get(c);C.count++,C.items.push(r)}const n=(r,b)=>r.localeCompare(b,"id",{sensitivity:"base"});return Array.from(t.values()).map(r=>{const b=Array.from(r.contMap.values()).map(m=>(m.items.sort((u,c)=>{var s,g;const C=(((s=u==null?void 0:u.participant)==null?void 0:s.full_name)||(u==null?void 0:u.full_name)||(u==null?void 0:u.team_name)||(u==null?void 0:u.contingent)||"").toString(),w=(((g=c==null?void 0:c.participant)==null?void 0:g.full_name)||(c==null?void 0:c.full_name)||(c==null?void 0:c.team_name)||(c==null?void 0:c.contingent)||"").toString();return n(C,w)}),m)).sort((m,u)=>n(m.name,u.name));return{id:r.id,name:r.name,count:r.count,contingents:b}}).sort((r,b)=>n(r.name,b.name))}),q=G(!1),h=G(null),L=p(()=>{var e;return((e=h.value)==null?void 0:e.judges)||[]}),A=p(()=>{var e;return((e=h.value)==null?void 0:e.components)||[]}),it=p(()=>{var e;return((e=h.value)==null?void 0:e.scoresheets)||[]}),T=G({}),I=G(!1),gt=e=>{var n,l,f,r;const t=[];for(const b of L.value||[]){const m=(r=(f=(l=(n=T.value)==null?void 0:n[b.id])==null?void 0:l.itemsMap)==null?void 0:f[e])==null?void 0:r.score;m==null||m===""||t.push(Number(m))}return t},ot=e=>{const t=gt(e);if(!t.length)return{ok:!0,diff:0,min:null,max:null};const n=Math.min(...t),l=Math.max(...t),f=Math.round((l-n)*100)/100;return{ok:f<=K,diff:f,min:n,max:l}},lt=p(()=>{const e=[];for(const t of A.value||[]){const n=ot(t.id);n.ok||e.push({component_id:t.id,field_name:t.field_name,...n})}return e}),D=p(()=>lt.value.length===0),bt=e=>e==="draft"?"badge-secondary":e==="submitted"?"badge-success":e==="locked"?"badge-danger":"badge-light",V=e=>Number(e||0).toFixed(2),H=e=>{const t=(it.value||[]).find(n=>String(n.judge_id)===String(e));return(t==null?void 0:t.status)||null},Q=e=>H(e)==="locked",rt=(e,t)=>{var r,b,m,u;const n=A.value.find(c=>String(c.id)===String(t)),l=Number(((u=(m=(b=(r=T.value)==null?void 0:r[e])==null?void 0:b.itemsMap)==null?void 0:m[t])==null?void 0:u.score)||0),f=Number((n==null?void 0:n.weight)||0);return f?l*(f/100):l},Y=e=>{let t=0;for(const n of A.value||[])t+=Number(rt(e,n.id)||0);return Math.round(t*100)/100},pt=p(()=>{const e=L.value||[];if(!e.length)return 0;const t=e.reduce((n,l)=>n+Number(Y(l.id)||0),0);return Math.round(t/e.length*100)/100}),_t=e=>{const t=Number((e==null?void 0:e.max_score)||0),n=Number((e==null?void 0:e.weight)||0);return n?t*(n/100):t},ht=(e,t)=>{const n=A.value.find(r=>String(r.id)===String(t)),l=Number((n==null?void 0:n.max_score)||0);let f=Number(T.value[e].itemsMap[t].score||0);f<0&&(f=0),l>0&&f>l&&(f=l),T.value[e].itemsMap[t].score=f},E=p(()=>{const e=it.value||[];return e.length?e.some(t=>t.status==="locked")?"locked":e.some(t=>t.status==="submitted")?"submitted":e.some(t=>t.status==="draft")?"draft":"new":"new"}),yt=p(()=>E.value==="new"||E.value==="draft"),kt=p(()=>E.value==="draft"),xt=p(()=>E.value==="submitted"),wt=p(()=>L.value.some(e=>!Q(e.id))),St=p(()=>L.value.some(e=>!Q(e.id))),Mt=p(()=>L.value.length>0),Nt=p(()=>I.value||!wt.value||E.value==="locked"||!D.value),Ct=p(()=>I.value||!St.value||E.value!=="draft"||!D.value),Bt=p(()=>I.value||!Mt.value||E.value!=="submitted"||!D.value),$t=async()=>{if(B.value){j.value=!0;try{const{data:e}=await R.get(`/api/v1/events/${B.value}/competitions/tree`,{params:{search:""}});et.value=e.rounds||[]}catch(e){console.error(e),y.fire("Gagal","Gagal memuat daftar kompetisi.","error")}finally{j.value=!1}}},ut=async()=>{if(!_.value){$.value=null;return}try{const{data:e}=await R.get(`/api/v1/event-competitions/${_.value}`);$.value=e}catch(e){console.error(e),$.value=null,y.fire("Gagal","Gagal memuat info kompetisi.","error")}},dt=async()=>{var t;if(!B.value)return;const e=(t=$.value)==null?void 0:t.event_group_id;if(!e){W.value=[];return}O.value=!0;try{const{data:n}=await R.get(`/api/v1/events/${B.value}/participants/simple`,{params:{per_page:2e3,event_group_id:e,is_team:N.value?1:0,only_verified:1}});W.value=n.data||n||[]}catch(n){console.error(n),y.fire("Gagal",`Gagal memuat daftar ${N.value?"tim":"peserta"}.`,"error")}finally{O.value=!1}},U=async()=>{var e,t;if(!(!_.value||!k.value)){q.value=!0;try{const{data:n}=await R.get(`/api/v1/event-competitions/${_.value}/scoring/form`,{params:{event_participant_id:k.value}});h.value=n,Tt()}catch(n){console.error(n),y.fire("Gagal",((t=(e=n==null?void 0:n.response)==null?void 0:e.data)==null?void 0:t.message)||"Gagal memuat form penilaian.","error")}finally{q.value=!1}}},Tt=()=>{var f,r,b;const e=((f=h.value)==null?void 0:f.judges)||[],t=((r=h.value)==null?void 0:r.components)||[],n=((b=h.value)==null?void 0:b.scoresheets)||[],l={};for(const m of e){const u=n.find(w=>String(w.judge_id)===String(m.id)),c=(u==null?void 0:u.items)||[],C={};for(const w of t){const s=c.find(Vt=>String(Vt.event_field_component_id)===String(w.id)),g=Number((w==null?void 0:w.max_score)||0);let S=Number((s==null?void 0:s.score)??0);S<0&&(S=0),g>0&&S>g&&(S=g),C[w.id]={event_field_component_id:w.id,score:S,notes:(s==null?void 0:s.notes)??""}}l[m.id]={judge_id:m.id,status:(u==null?void 0:u.status)||"draft",itemsMap:C}}T.value=l},Lt=()=>{var t;const e=[];for(const n of L.value||[]){const l=(t=T.value)==null?void 0:t[n.id];if(!l)continue;const f=(A.value||[]).map(r=>{var b,m,u,c;return{event_field_component_id:r.id,score:Number(((m=(b=l.itemsMap)==null?void 0:b[r.id])==null?void 0:m.score)??0),notes:((c=(u=l.itemsMap)==null?void 0:u[r.id])==null?void 0:c.notes)??null}});e.push({judge_id:n.id,items:f})}return e},Gt=async()=>{var t,n;if(!_.value||!k.value)return;if(!D.value){y.fire("Tidak bisa menyimpan",`Selisih nilai antar hakim pada satu bidang tidak boleh > ${K} poin.`,"warning");return}if((await y.fire({title:"Simpan draft?",text:"Nilai akan disimpan sebagai draft untuk semua hakim.",icon:"question",showCancelButton:!0,confirmButtonText:"Simpan",cancelButtonText:"Batal"})).isConfirmed){I.value=!0;try{await R.post(`/api/v1/event-competitions/${_.value}/scoring/draft`,{event_participant_id:k.value,rows:Lt()}),y.fire("Berhasil","Draft tersimpan.","success"),await U()}catch(l){console.error(l),y.fire("Gagal",((n=(t=l==null?void 0:l.response)==null?void 0:t.data)==null?void 0:n.message)||"Gagal menyimpan draft.","error")}finally{I.value=!1}}},It=async()=>{var t,n;if(!_.value||!k.value)return;if(!D.value){y.fire("Tidak bisa menyimpan",`Selisih nilai antar hakim pada satu bidang tidak boleh > ${K} poin.`,"warning");return}if((await y.fire({title:"Submit nilai?",text:"Status nilai akan menjadi submitted (selama belum locked).",icon:"warning",showCancelButton:!0,confirmButtonText:"Submit",cancelButtonText:"Batal"})).isConfirmed){I.value=!0;try{await R.post(`/api/v1/event-competitions/${_.value}/scoring/submit`,{event_participant_id:k.value}),y.fire("Berhasil","Nilai submitted.","success"),await U()}catch(l){console.error(l),y.fire("Gagal",((n=(t=l==null?void 0:l.response)==null?void 0:t.data)==null?void 0:n.message)||"Gagal submit nilai.","error")}finally{I.value=!1}}},Pt=async()=>{var t,n;if(!_.value||!k.value)return;if(!D.value){y.fire("Tidak bisa menyimpan",`Selisih nilai antar hakim pada satu bidang tidak boleh > ${K} poin.`,"warning");return}if((await y.fire({title:"Lock nilai?",text:"Nilai akan dikunci dan tidak bisa diubah lagi.",icon:"warning",showCancelButton:!0,confirmButtonText:"Lock",cancelButtonText:"Batal",confirmButtonColor:"#d33"})).isConfirmed){I.value=!0;try{await R.post(`/api/v1/event-competitions/${_.value}/scoring/lock`,{event_participant_id:k.value}),y.fire("Berhasil","Nilai locked.","success"),await U()}catch(l){console.error(l),y.fire("Gagal",((n=(t=l==null?void 0:l.response)==null?void 0:t.data)==null?void 0:n.message)||"Gagal lock nilai.","error")}finally{I.value=!1}}},Z=async()=>{await $t(),_.value?(await ut(),await dt()):(W.value=[],$.value=null),_.value&&k.value&&await U()};return z(()=>J.params.id,e=>{_.value=String(e||"")}),z(()=>J.query.event_participant_id,e=>{k.value=String(e||"")}),z(()=>B.value,async e=>{e&&await Z()}),z(()=>_.value,async e=>{k.value="",h.value=null,T.value={},W.value=[],$.value=null,e&&(await ut(),await dt())}),z(()=>k.value,async e=>{h.value=null,T.value={},e&&await U()}),Et(async()=>{if(!B.value){y.fire("Event belum dipilih","Silakan pilih event melalui Portal Event terlebih dahulu.","info");return}await Z()}),(e,t)=>{var n,l,f,r,b,m,u,c,C,w;return o(),i(M,null,[a("section",Kt,[a("div",Ut,[a("div",Ft,[a("div",null,[t[6]||(t[6]=a("h1",{class:"mb-1"},"Input Nilai Kompetisi",-1)),a("p",jt," Pilih kompetisi & "+d(N.value?"tim":"peserta")+", lalu input nilai per hakim untuk semua komponen penilaian. ",1),B.value?(o(),i("p",Ot,[t[2]||(t[2]=v(" Event aktif: ")),a("strong",null,d((n=F.value)==null?void 0:n.event_name),1),(l=F.value)!=null&&l.event_year?(o(),i("span",Wt," ("+d(F.value.event_year)+")",1)):x("",!0),t[3]||(t[3]=v(" • Lokasi: ")),a("strong",null,d(((f=F.value)==null?void 0:f.event_location)||"-"),1)])):x("",!0),$.value?(o(),i("div",qt,[t[4]||(t[4]=v(" Group: ")),a("strong",null,d(((b=(r=$.value)==null?void 0:r.event_group)==null?void 0:b.full_name)||"#"+(((m=$.value)==null?void 0:m.event_group_id)||"-")),1),t[5]||(t[5]=v(" • Mode: ")),a("span",{class:tt(["badge",N.value?"badge-info":"badge-light border"])},d(N.value?"TEAM":"INDIVIDUAL"),3)])):x("",!0)]),a("div",zt,[a("button",{class:"btn btn-sm btn-outline-secondary",disabled:!B.value||j.value,onClick:Z},t[7]||(t[7]=[a("i",{class:"fas fa-sync mr-1"},null,-1),v(" Refresh ")]),8,Jt)])]),B.value?x("",!0):(o(),i("p",Ht,t[8]||(t[8]=[a("i",{class:"fas fa-exclamation-triangle mr-1"},null,-1),v(" Event belum dipilih. Silakan pilih event melalui Portal Event terlebih dahulu. ")])))])]),a("section",Qt,[a("div",Xt,[a("div",Yt,[a("div",Zt,[a("div",te,[a("div",ee,[t[11]||(t[11]=a("label",{class:"mb-1 text-sm"},[v("Kompetisi "),a("span",{class:"text-danger"},"*")],-1)),X(a("select",{"onUpdate:modelValue":t[0]||(t[0]=s=>_.value=s),class:"form-control form-control-sm",disabled:!B.value||j.value},[t[9]||(t[9]=a("option",{value:"",disabled:""},"-- Pilih Kompetisi --",-1)),(o(!0),i(M,null,P(et.value,s=>(o(),i("optgroup",{key:"round-"+s.id,label:s.name},[(o(!0),i(M,null,P(s.competitions,g=>(o(),i("option",{key:g.id,value:String(g.id)},d(g.full_name),9,se))),128))],8,ne))),128))],8,ae),[[mt,_.value]]),j.value?(o(),i("small",ie,t[10]||(t[10]=[a("i",{class:"fas fa-spinner fa-spin mr-1"},null,-1),v(" Memuat daftar kompetisi... ")]))):x("",!0)]),a("div",oe,[a("label",le,[v(d(N.value?"Tim":"Peserta")+" (Event Participant) ",1),t[12]||(t[12]=a("span",{class:"text-danger"},"*",-1))]),X(a("select",{"onUpdate:modelValue":t[1]||(t[1]=s=>k.value=s),class:"form-control form-control-sm",disabled:!B.value||!_.value||!((u=$.value)!=null&&u.event_group_id)||O.value},[a("option",ue,d(O.value?`Memuat ${N.value?"tim":"peserta"}...`:`-- Pilih ${N.value?"Tim":"Peserta"} --`),1),!O.value&&st.value.length===0?(o(),i("option",de," Tidak ada data "+d(N.value?"tim":"peserta")+". ",1)):x("",!0),(o(!0),i(M,null,P(st.value,s=>(o(),i("optgroup",{key:"cat-"+s.id,label:`${s.name} (${s.count})`},[(o(!0),i(M,null,P(s.contingents,g=>(o(),i(M,{key:"cont-"+s.id+"-"+g.name},[a("option",ce," — "+d(g.name)+" ("+d(g.count)+") ",1),(o(!0),i(M,null,P(g.items,S=>(o(),i("option",{key:"p-"+S.id,value:String(S.id)},d(ft(S,s.name,g.name)),9,ve))),128))],64))),128))],8,me))),128))],8,re),[[mt,k.value]]),_.value?$.value&&N.value?(o(),i("small",ge," Mode team aktif: daftar yang tampil adalah tim pada group ini. ")):x("",!0):(o(),i("small",fe,"Pilih kompetisi dulu."))])])])]),_.value&&k.value?(o(),i("div",be,[a("div",pe,[a("div",null,[a("strong",null,d(((C=(c=h.value)==null?void 0:c.competition)==null?void 0:C.full_name)||"Kompetisi"),1),(w=h.value)!=null&&w.participant?(o(),i("div",_e,[N.value?(o(),i(M,{key:0},[t[13]||(t[13]=v(" Tim: ")),a("strong",null,d(h.value.participant.team_name||h.value.participant.contingent||h.value.participant.full_name),1),t[14]||(t[14]=a("span",{class:"ml-2"},"•",-1)),t[15]||(t[15]=v(" Kategori: ")),a("strong",null,d(h.value.participant.category_name||"-"),1)],64)):(o(),i(M,{key:1},[t[16]||(t[16]=v(" Peserta: ")),a("strong",null,d(h.value.participant.full_name),1),t[17]||(t[17]=a("span",{class:"ml-2"},"•",-1)),t[18]||(t[18]=v(" NIK: ")),a("strong",null,d(h.value.participant.nik||"-"),1),t[19]||(t[19]=a("span",{class:"ml-2"},"•",-1)),t[20]||(t[20]=v(" Kontingen: ")),a("strong",null,d(h.value.participant.contingent||"-"),1)],64))])):x("",!0)]),a("div",he,[a("button",{class:"btn btn-sm btn-outline-primary",disabled:q.value,onClick:U},t[21]||(t[21]=[a("i",{class:"fas fa-sync mr-1"},null,-1),v(" Reload Form ")]),8,ye)])]),!q.value&&L.value.length&&A.value.length?(o(),i("div",ke,[a("table",xe,[a("thead",we,[a("tr",null,[t[23]||(t[23]=a("th",{style:{"min-width":"280px"}},"Komponen",-1)),(o(!0),i(M,null,P(L.value,s=>(o(),i("th",{key:"j-"+s.id,style:{"min-width":"260px"},class:"text-center"},[a("div",Se,[a("div",Me,d(s.name),1),a("div",Ne,[t[22]||(t[22]=v(" Total: ")),a("span",Ce,d(V(Y(s.id))),1),H(s.id)?(o(),i("span",{key:0,class:tt(["ml-1 badge",bt(H(s.id))])},d(H(s.id)),3)):x("",!0)])])]))),128))])]),a("tbody",null,[(o(!0),i(M,null,P(A.value,s=>(o(),i("tr",{key:"c-"+s.id,class:tt({"table-warning":!ot(s.id).ok})},[a("td",null,[a("div",Be,[a("div",null,[a("strong",null,d(s.field_name),1),a("div",$e,[t[24]||(t[24]=v(" Max: ")),a("strong",null,d(V(s.max_score||0)),1),t[25]||(t[25]=v(" • Weight: ")),a("strong",null,d(s.weight??0)+"%",1)])]),a("span",Te," Max Weighted: "+d(V(_t(s))),1)])]),(o(!0),i(M,null,P(L.value,g=>(o(),i("td",{key:"cell-"+s.id+"-"+g.id},[a("div",Le,[a("div",Ge,[X(a("input",{type:"number",step:"0.01",min:"0",class:"form-control form-control-sm",disabled:Q(g.id),max:Number(s.max_score||0)||null,"onUpdate:modelValue":S=>T.value[g.id].itemsMap[s.id].score=S,onInput:S=>ht(g.id,s.id),placeholder:"Score"},null,40,Ie),[[ct,T.value[g.id].itemsMap[s.id].score,void 0,{number:!0}]]),a("small",Pe,[t[26]||(t[26]=v(" W: ")),a("strong",null,d(V(rt(g.id,s.id))),1)])]),a("div",Ve,[X(a("input",{type:"text",class:"form-control form-control-sm",disabled:Q(g.id),"onUpdate:modelValue":S=>T.value[g.id].itemsMap[s.id].notes=S,placeholder:"Catatan"},null,8,Ae),[[ct,T.value[g.id].itemsMap[s.id].notes]]),a("small",{class:"text-muted text-xs d-block mt-1"}," Range max: "+d(K)+" poin ")])])]))),128))],2))),128)),a("tr",De,[t[27]||(t[27]=a("td",{class:"text-right font-weight-bold"},"TOTAL",-1)),(o(!0),i(M,null,P(L.value,s=>(o(),i("td",{key:"total-"+s.id,class:"text-center"},[a("span",Ee,d(V(Y(s.id))),1)]))),128))]),a("tr",Re,[t[29]||(t[29]=a("td",{class:"text-right font-weight-bold"},"FINAL (AVG Hakim)",-1)),a("td",{colspan:L.value.length,class:"text-center"},[a("span",Ue,d(V(pt.value)),1),t[28]||(t[28]=a("span",{class:"text-muted text-xs ml-2"}," (rata-rata total semua hakim) ",-1))],8,Ke)])])])])):(o(),i("div",Fe,[q.value?(o(),i("div",je,t[30]||(t[30]=[a("i",{class:"fas fa-spinner fa-spin mr-1"},null,-1),v(" Memuat form penilaian... ")]))):(o(),i("div",Oe," Hakim / Komponen belum tersedia untuk kompetisi ini. "))])),a("div",We,[a("div",qe,[a("div",{class:"text-muted text-sm"},[t[33]||(t[33]=a("div",{class:"mb-1"},[a("span",{class:"badge badge-light border"},"Auto hitung: score × (weight/100)"),a("span",{class:"ml-2 badge badge-light border"},"Score dipotong jika melebihi max")],-1)),a("div",{class:"text-xs"},[t[31]||(t[31]=v(" Range antar hakim per komponen maksimal ")),a("strong",null,d(K)),t[32]||(t[32]=v(" poin. "))])]),D.value?x("",!0):(o(),i("div",ze,[a("div",Je,[t[37]||(t[37]=a("i",{class:"fas fa-exclamation-triangle mr-2 mt-1"},null,-1)),a("div",null,[t[36]||(t[36]=a("div",{class:"font-weight-bold"},"Validasi gagal",-1)),a("div",{class:"text-sm"},[t[34]||(t[34]=v(" Selisih nilai antar hakim pada satu bidang tidak boleh lebih dari ")),a("strong",null,d(K)),t[35]||(t[35]=v(" poin. "))]),a("ul",He,[(o(!0),i(M,null,P(lt.value,s=>(o(),i("li",{key:"inv-"+s.component_id},[a("strong",null,d(s.field_name),1),v(" — rentang: "+d(V(s.min))+" s/d "+d(V(s.max))+" (selisih "+d(V(s.diff))+") ",1)]))),128))])])])])),a("div",Qe,[yt.value?(o(),i("button",{key:0,class:"btn btn-sm btn-outline-primary",disabled:Nt.value,onClick:Gt},[I.value?(o(),i("i",Ye)):x("",!0),t[38]||(t[38]=v(" Save Draft "))],8,Xe)):x("",!0),kt.value?(o(),i("button",{key:1,class:"btn btn-sm btn-outline-success",disabled:Ct.value,onClick:It}," Submit ",8,Ze)):x("",!0),xt.value?(o(),i("button",{key:2,class:"btn btn-sm btn-outline-danger",disabled:Bt.value,onClick:Pt}," Lock ",8,ta)):x("",!0)])])])])):B.value?(o(),i("div",ea,[t[39]||(t[39]=v(" Pilih ")),t[40]||(t[40]=a("strong",null,"kompetisi",-1)),t[41]||(t[41]=v(" dan ")),a("strong",null,d(N.value?"tim":"peserta"),1),t[42]||(t[42]=v(" untuk mulai input nilai. "))])):x("",!0)])])],64)}}},la=Rt(aa,[["__scopeId","data-v-0f449f35"]]);export{la as default};
