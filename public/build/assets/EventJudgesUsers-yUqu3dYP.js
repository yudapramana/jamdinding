import{z as Y,y as H,A as b,O as M,V as q,B as p,C as f,D as e,I as k,J as i,K as r,S as g,aB as B,as as w,U as T,ay as O,H as D,F as G,a as h,aC as Q}from"./AuthUserStore-B6VIMEgo.js";import{S as v}from"./sweetalert2.esm.all-9Qm2jZ7z.js";import{_ as R}from"./app-DdJgNepn.js";const X={class:"content-header"},Z={class:"container-fluid"},ee={class:"d-flex justify-content-between align-items-center"},te={key:0,class:"mb-0 mt-1 text-sm text-muted"},ae={key:0},se=["disabled"],le={key:0,class:"text-danger text-sm mt-2 mb-0"},oe={class:"content"},ne={class:"container-fluid"},ie={class:"card"},re={class:"card-header"},de={class:"d-flex flex-wrap justify-content-between align-items-center w-100"},ue={class:"d-flex flex-wrap align-items-center"},me={class:"d-flex align-items-center mt-2 mt-sm-0"},ve={class:"card-body table-responsive p-0"},ce={class:"table table-bordered table-hover text-sm mb-0"},pe={key:0},fe={key:1},ge={class:"text-center"},be={class:"text-xs text-muted"},_e={key:0,class:"badge badge-light border"},xe={class:"badge badge-light border"},ke={class:"text-center"},we={class:"text-center"},he={class:"btn-group btn-group-sm"},ye=["onClick"],Ue=["title","onClick"],Ce=["onClick"],Me={class:"card-footer clearfix py-2"},Be={class:"d-flex justify-content-between align-items-center"},De={class:"text-muted text-sm"},Ee={class:"pagination pagination-sm m-0"},$e={class:"page-item disabled"},Ne={class:"page-link"},je={class:"modal fade",id:"judgeUserModal",tabindex:"-1",role:"dialog","aria-hidden":"true"},Ae={class:"modal-dialog modal-lg",role:"document"},Se={class:"modal-content"},Ve={class:"modal-header"},He={class:"modal-title"},Te={class:"modal-body"},Ge={class:"form-row"},Ie={class:"form-group col-md-6"},Pe={class:"form-group col-md-6"},Fe={class:"form-row"},Ke={class:"form-group col-md-6"},Je={class:"form-group col-md-6"},Le={class:"form-row"},We={class:"form-group col-md-4"},ze={class:"form-group col-md-4"},Ye={class:"form-group col-md-4"},qe=["value"],Oe={class:"modal-footer"},Qe=["disabled"],Re={__name:"EventJudgesUsers",setup(Xe){const I=Y(),_=H(()=>I.eventData||null),u=H(()=>{var a;return((a=_.value)==null?void 0:a.id)||null}),E=b([]),y=b(""),U=b(10),N=b(!1),C=b({is_active:""}),n=b({current_page:1,per_page:10,total:0,from:0,to:0,last_page:1}),P=a=>a+1+(n.value.current_page-1)*n.value.per_page,j=b(!1),l=b(A());function A(){return{id:null,name:"",username:"",email:"",password:"",is_active:!0,can_multiple_role:!0}}const F=()=>{l.value=A(),$("#judgeUserModal").modal("show")},K=a=>{l.value={id:a.id,name:a.name||"",username:a.username||"",email:a.email||"",password:"",is_active:!!a.is_active,can_multiple_role:!!a.can_multiple_role},$("#judgeUserModal").modal("show")},c=async(a=1)=>{if(u.value){N.value=!0;try{const o=(await h.get(`/api/v1/events/${u.value}/judges`,{params:{page:a,per_page:U.value,search:y.value,is_active:C.value.is_active}})).data;E.value=o.data||[],n.value={current_page:o.current_page,per_page:o.per_page,total:o.total,from:o.from,to:o.to,last_page:o.last_page}}catch(t){console.error(t),v.fire("Gagal","Gagal memuat data dewan hakim.","error")}finally{N.value=!1}}},J=async()=>{var t,o;if(!u.value)return;const a={name:l.value.name,username:l.value.username,email:l.value.email,is_active:!!l.value.is_active,can_multiple_role:!!l.value.can_multiple_role,password:l.value.password||null,event_id:u.value};if(!a.name||!a.username||!a.email){v.fire("Validasi","Nama, username, dan email wajib diisi.","warning");return}j.value=!0;try{l.value.id?(await h.put(`/api/v1/judges/${l.value.id}`,a),v.fire("Berhasil","Dewan hakim berhasil diperbarui.","success")):(await h.post(`/api/v1/events/${u.value}/judges`,a),v.fire("Berhasil","Dewan hakim berhasil ditambahkan.","success")),$("#judgeUserModal").modal("hide"),c(n.value.current_page||1)}catch(d){const m=((o=(t=d==null?void 0:d.response)==null?void 0:t.data)==null?void 0:o.message)||"Gagal menyimpan data.";v.fire("Gagal",m,"error")}finally{j.value=!1}},L=async a=>{var d,m;const t=!a.is_active;if((await v.fire({title:t?"Aktifkan user?":"Nonaktifkan user?",text:`${a.name} (${a.username})`,icon:"question",showCancelButton:!0,confirmButtonText:"Ya",cancelButtonText:"Batal"})).isConfirmed)try{await h.patch(`/api/v1/judges/${a.id}/toggle-active`,{is_active:t}),c(n.value.current_page||1)}catch(x){v.fire("Gagal",((m=(d=x==null?void 0:x.response)==null?void 0:d.data)==null?void 0:m.message)||"Gagal mengubah status.","error")}},W=async a=>{var o,d;if((await v.fire({title:"Hapus user?",text:`${a.name} (${a.username})`,icon:"warning",showCancelButton:!0,confirmButtonText:"Hapus",cancelButtonText:"Batal"})).isConfirmed)try{await h.delete(`/api/v1/judges/${a.id}`),v.fire("Berhasil","User berhasil dihapus.","success"),c(1)}catch(m){v.fire("Gagal",((d=(o=m==null?void 0:m.response)==null?void 0:o.data)==null?void 0:d.message)||"Gagal menghapus user.","error")}},S=a=>{a<1||a>n.value.last_page||c(a)};return M(()=>y.value,Q(()=>c(1),400)),M(()=>U.value,()=>c(1)),M(()=>({...C.value}),()=>c(1)),M(()=>u.value,a=>{a&&c(1)}),q(()=>{u.value?c(1):v.fire("Event belum dipilih","Silakan pilih event melalui Portal Event terlebih dahulu.","info")}),(a,t)=>{var o,d,m,x;return f(),p(T,null,[e("section",X,[e("div",Z,[e("div",ee,[e("div",null,[t[13]||(t[13]=e("h1",{class:"mb-1"},"Manajemen Dewan Hakim",-1)),t[14]||(t[14]=e("p",{class:"mb-0 text-muted text-sm"},[i(" Mengelola user khusus role "),e("strong",null,"DEWAN_HAKIM"),i(" pada event aktif. ")],-1)),u.value?(f(),p("p",te,[t[11]||(t[11]=i(" Event aktif: ")),e("strong",null,r((o=_.value)==null?void 0:o.event_name),1),(d=_.value)!=null&&d.event_year?(f(),p("span",ae," ("+r(_.value.event_year)+")",1)):k("",!0),t[12]||(t[12]=i(" • Lokasi: ")),e("strong",null,r(((m=_.value)==null?void 0:m.event_location)||"-"),1)])):k("",!0)]),e("div",null,[e("button",{class:"btn btn-sm btn-primary",disabled:!u.value,onClick:F},t[15]||(t[15]=[e("i",{class:"fas fa-plus mr-1"},null,-1),i(" Tambah Dewan Hakim ")]),8,se)])]),u.value?k("",!0):(f(),p("p",le,t[16]||(t[16]=[e("i",{class:"fas fa-exclamation-triangle mr-1"},null,-1),i(" Event belum dipilih. Silakan pilih event melalui Portal Event terlebih dahulu. ")])))])]),e("section",oe,[e("div",ne,[e("div",ie,[e("div",re,[e("div",de,[e("div",ue,[t[19]||(t[19]=e("label",{class:"mb-0 mr-1 text-sm text-muted"},"Tampilkan",-1)),g(e("select",{"onUpdate:modelValue":t[0]||(t[0]=s=>U.value=s),class:"form-control form-control-sm w-auto mr-2"},t[17]||(t[17]=[e("option",{value:10},"10",-1),e("option",{value:25},"25",-1),e("option",{value:50},"50",-1),e("option",{value:100},"100",-1)]),512),[[B,U.value,void 0,{number:!0}]]),t[20]||(t[20]=e("label",{class:"mb-0 text-sm text-muted mr-3"},"Entri",-1)),t[21]||(t[21]=e("label",{class:"mb-0 mr-1 text-sm text-muted"},"Status",-1)),g(e("select",{"onUpdate:modelValue":t[1]||(t[1]=s=>C.value.is_active=s),class:"form-control form-control-sm w-auto mr-2"},t[18]||(t[18]=[e("option",{value:""},"Semua",-1),e("option",{value:"1"},"Aktif",-1),e("option",{value:"0"},"Nonaktif",-1)]),512),[[B,C.value.is_active]])]),e("div",me,[g(e("input",{"onUpdate:modelValue":t[2]||(t[2]=s=>y.value=s),type:"text",class:"form-control form-control-sm w-auto",style:{"min-width":"280px"},placeholder:"Cari nama / username / email..."},null,512),[[w,y.value]])])])]),e("div",ve,[e("table",ce,[t[27]||(t[27]=e("thead",{class:"thead-light"},[e("tr",null,[e("th",{style:{width:"50px"}},"#"),e("th",null,"Nama"),e("th",{style:{width:"200px"}},"Username"),e("th",{style:{width:"110px"},class:"text-center"},"Status"),e("th",{style:{width:"150px"},class:"text-center"},"Aksi")])],-1)),e("tbody",null,[N.value?(f(),p("tr",pe,t[22]||(t[22]=[e("td",{colspan:"6",class:"text-center py-4"},"Memuat data dewan hakim...",-1)]))):E.value.length===0?(f(),p("tr",fe,t[23]||(t[23]=[e("td",{colspan:"6",class:"text-center py-4"},[i(" Belum ada user dewan hakim untuk event ini. "),e("br"),e("small",{class:"text-muted"},[i(" Klik "),e("strong",null,"Tambah Dewan Hakim"),i(" untuk menambahkan user. ")])],-1)]))):k("",!0),(f(!0),p(T,null,O(E.value,(s,z)=>(f(),p("tr",{key:s.id},[e("td",ge,r(P(z)),1),e("td",null,[e("strong",null,r(s.name),1),e("div",be,[t[24]||(t[24]=e("span",{class:"badge badge-light border mr-1"},"DEWAN_HAKIM",-1)),s.can_multiple_role?(f(),p("span",_e,"multi-role")):k("",!0)])]),e("td",null,[e("span",xe,r(s.username),1)]),e("td",ke,[e("span",{class:D(["badge",s.is_active?"badge-success":"badge-secondary"])},r(s.is_active?"Aktif":"Nonaktif"),3)]),e("td",we,[e("div",he,[e("button",{class:"btn btn-outline-primary btn-xs",title:"Edit",onClick:V=>K(s)},t[25]||(t[25]=[e("i",{class:"fas fa-edit"},null,-1)]),8,ye),e("button",{class:"btn btn-outline-warning btn-xs",title:s.is_active?"Nonaktifkan":"Aktifkan",onClick:V=>L(s)},[e("i",{class:D(["fas",s.is_active?"fa-user-slash":"fa-user-check"])},null,2)],8,Ue),e("button",{class:"btn btn-outline-danger btn-xs",title:"Hapus",onClick:V=>W(s)},t[26]||(t[26]=[e("i",{class:"fas fa-trash"},null,-1)]),8,Ce)])])]))),128))])])]),e("div",Me,[e("div",Be,[e("div",De," Menampilkan "+r(n.value.from||0)+" - "+r(n.value.to||0)+" dari "+r(n.value.total||0)+" dewan hakim ",1),e("ul",Ee,[e("li",{class:D(["page-item",{disabled:n.value.current_page===1}])},[e("a",{href:"#",class:"page-link",onClick:t[3]||(t[3]=G(s=>S(n.value.current_page-1),["prevent"]))},"«")],2),e("li",$e,[e("span",Ne,"Halaman "+r(n.value.current_page)+" / "+r(n.value.last_page||1),1)]),e("li",{class:D(["page-item",{disabled:n.value.current_page===n.value.last_page}])},[e("a",{href:"#",class:"page-link",onClick:t[4]||(t[4]=G(s=>S(n.value.current_page+1),["prevent"]))},"»")],2)])])])])]),e("div",je,[e("div",Ae,[e("div",Se,[e("div",Ve,[e("h5",He,r(l.value.id?"Edit Dewan Hakim":"Tambah Dewan Hakim"),1),t[28]||(t[28]=e("button",{type:"button",class:"close","data-dismiss":"modal"},[e("span",null,"×")],-1))]),e("div",Te,[t[38]||(t[38]=e("div",{class:"alert alert-light border text-sm mb-3"},[i(" User yang dibuat lewat halaman ini otomatis diberi role "),e("strong",null,"DEWAN_HAKIM"),i(" dan diset ke "),e("strong",null,"event aktif"),i(". ")],-1)),e("div",Ge,[e("div",Ie,[t[29]||(t[29]=e("label",{class:"text-sm text-muted mb-1"},"Nama",-1)),g(e("input",{"onUpdate:modelValue":t[5]||(t[5]=s=>l.value.name=s),type:"text",class:"form-control form-control-sm",placeholder:"Nama lengkap"},null,512),[[w,l.value.name,void 0,{trim:!0}]])]),e("div",Pe,[t[30]||(t[30]=e("label",{class:"text-sm text-muted mb-1"},"Username",-1)),g(e("input",{"onUpdate:modelValue":t[6]||(t[6]=s=>l.value.username=s),type:"text",class:"form-control form-control-sm",placeholder:"Username unik"},null,512),[[w,l.value.username,void 0,{trim:!0}]])])]),e("div",Fe,[e("div",Ke,[t[31]||(t[31]=e("label",{class:"text-sm text-muted mb-1"},"Email",-1)),g(e("input",{"onUpdate:modelValue":t[7]||(t[7]=s=>l.value.email=s),type:"email",class:"form-control form-control-sm",placeholder:"email@domain"},null,512),[[w,l.value.email,void 0,{trim:!0}]])]),e("div",Je,[t[32]||(t[32]=e("label",{class:"text-sm text-muted mb-1"},[i(" Password "),e("small",{class:"text-muted"},"(kosongkan jika tidak ingin mengubah)")],-1)),g(e("input",{"onUpdate:modelValue":t[8]||(t[8]=s=>l.value.password=s),type:"password",class:"form-control form-control-sm",placeholder:"Password"},null,512),[[w,l.value.password]])])]),e("div",Le,[e("div",We,[t[34]||(t[34]=e("label",{class:"text-sm text-muted mb-1"},"Status",-1)),g(e("select",{"onUpdate:modelValue":t[9]||(t[9]=s=>l.value.is_active=s),class:"form-control form-control-sm"},t[33]||(t[33]=[e("option",{value:!0},"Aktif",-1),e("option",{value:!1},"Nonaktif",-1)]),512),[[B,l.value.is_active]])]),e("div",ze,[t[36]||(t[36]=e("label",{class:"text-sm text-muted mb-1"},"Multi-role",-1)),g(e("select",{"onUpdate:modelValue":t[10]||(t[10]=s=>l.value.can_multiple_role=s),class:"form-control form-control-sm"},t[35]||(t[35]=[e("option",{value:!0},"Ya",-1),e("option",{value:!1},"Tidak",-1)]),512),[[B,l.value.can_multiple_role]])]),e("div",Ye,[t[37]||(t[37]=e("label",{class:"text-sm text-muted mb-1"},"Event",-1)),e("input",{class:"form-control form-control-sm",value:((x=_.value)==null?void 0:x.event_name)||"-",disabled:""},null,8,qe)])])]),e("div",Oe,[t[40]||(t[40]=e("button",{class:"btn btn-sm btn-secondary","data-dismiss":"modal"},"Tutup",-1)),e("button",{class:"btn btn-sm btn-primary",disabled:j.value||!u.value,onClick:J},t[39]||(t[39]=[e("i",{class:"fas fa-save mr-1"},null,-1),i(" Simpan ")]),8,Qe)])])])])])],64)}}},at=R(Re,[["__scopeId","data-v-67aa88af"]]);export{at as default};
