import{z as H,y as M,J as d,K as b,V as J,A as r,B as i,C as e,O as v,S as p,M as l,P as S,R as E,aB as Y,as as q,U,ay as Q,G as K,D as N,a as W,aC as X}from"./AuthUserStore-Du_wEH36.js";import{S as V}from"./sweetalert2.esm.all-9Qm2jZ7z.js";import{_ as Z}from"./ViewParticipantModal-lvsaVt7d.js";import{R as ee}from"./ReRegisterModal-DEOfxoTT.js";import{_ as te}from"./app-D2SkCNoG.js";const ae={class:"content-header"},se={class:"container-fluid"},ne={class:"d-flex justify-content-between align-items-center"},le={key:0,class:"mb-0 mt-1 text-sm text-muted"},oe={key:0},re={key:0,class:"text-danger text-sm mt-2 mb-0"},ie={class:"content"},ue={class:"container-fluid"},de={class:"card"},ce={class:"card-header"},ve={class:"d-flex flex-wrap justify-content-between align-items-center w-100"},pe={class:"d-flex flex-wrap align-items-center"},me={class:"d-flex align-items-center mt-2 mt-sm-0"},ge=["disabled"],_e={class:"card-body table-responsive p-0"},fe={class:"table table-bordered table-hover text-sm mb-0"},be={key:0},he={key:1},xe={class:"text-center"},ye={key:0,class:"text-xs text-muted"},ke={key:0,class:"text-xs text-muted"},we={class:"badge badge-light border"},Pe={class:"text-center"},Ce={class:"btn-group btn-group-sm"},De=["onClick"],Re=["onClick"],Me={class:"card-footer clearfix py-2"},Se={class:"d-flex justify-content-between align-items-center"},Ee={class:"text-muted text-sm"},Ue={class:"pagination pagination-sm m-0"},$e={class:"page-item disabled"},Ke={class:"page-link"},Ne={__name:"EventParticipantsFinal",setup(Ve){const B=H(),m=M(()=>B.eventData||null),u=M(()=>{var a;return((a=m.value)==null?void 0:a.id)||null}),h=d([]),g=d(""),_=d(10),f=d(!1),F=d({reregistration_status:""}),n=d({current_page:1,per_page:10,total:0,from:0,to:0,last_page:1}),x=d(null),L=a=>{x.value=a,$("#viewParticipantModal").modal("show")},y=d(null),I=a=>{const t=["verified","diterima","accepted"].includes(((a==null?void 0:a.registration_status)||"").toLowerCase()),o=["not_yet","",null].includes(a==null?void 0:a.reregistration_status);return t&&o},G=a=>{y.value=a,$("#reRegisterModal").modal("show")},T=()=>{c(n.value.current_page||1)},j=a=>a+1+(n.value.current_page-1)*n.value.per_page,c=async(a=1)=>{if(u.value){f.value=!0;try{const o=(await W.get(`/api/v1/events/${u.value}/participants`,{params:{page:a,per_page:_.value,search:g.value,registration_status:"verified",reregistration_status:"verified"}})).data;h.value=o.data||[],n.value={current_page:o.current_page,per_page:o.per_page,total:o.total,from:o.from,to:o.to,last_page:o.last_page}}catch(t){console.error(t),V.fire("Gagal","Gagal memuat data peserta event.","error")}finally{f.value=!1}}},k=a=>{a<1||a>n.value.last_page||c(a)},A=async()=>{if(!u.value)return;const a=new URLSearchParams({per_page:String(_.value||10),search:g.value||"",registration_status:"verified",reregistration_status:"verified"}),t=`/api/v1/events/${u.value}/kafilah-pdf?${a.toString()}`;window.open(t,"_blank")};return b(()=>g.value,X(()=>c(1),400)),b(()=>_.value,()=>c(1)),b(()=>({...F.value}),()=>c(1)),b(()=>u.value,a=>{a&&c(1)}),J(()=>{u.value?c(1):V.fire("Event belum dipilih","Silakan pilih event melalui Portal Event terlebih dahulu.","info")}),(a,t)=>{var o,w,P;return i(),r(U,null,[e("section",ae,[e("div",se,[e("div",ne,[e("div",null,[t[6]||(t[6]=e("h1",{class:"mb-1"},"Pendaftaran Ulang Peserta",-1)),t[7]||(t[7]=e("p",{class:"mb-0 text-muted text-sm"}," Mengelola peserta yang terdaftar pada event aktif, yaitu daftar ulang. ",-1)),u.value?(i(),r("p",le,[t[4]||(t[4]=p(" Event aktif: ")),e("strong",null,l((o=m.value)==null?void 0:o.event_name),1),(w=m.value)!=null&&w.event_year?(i(),r("span",oe," ("+l(m.value.event_year)+")",1)):v("",!0),t[5]||(t[5]=p(" • Lokasi: ")),e("strong",null,l(((P=m.value)==null?void 0:P.event_location)||"-"),1)])):v("",!0)])]),u.value?v("",!0):(i(),r("p",re,t[8]||(t[8]=[e("i",{class:"fas fa-exclamation-triangle mr-1"},null,-1),p(" Event belum dipilih. Silakan pilih event melalui Portal Event terlebih dahulu. ")])))])]),e("section",ie,[e("div",ue,[e("div",de,[e("div",ce,[e("div",ve,[e("div",pe,[t[10]||(t[10]=e("label",{class:"mb-0 mr-1 text-sm text-muted"},"Tampilkan",-1)),E(e("select",{"onUpdate:modelValue":t[0]||(t[0]=s=>_.value=s),class:"form-control form-control-sm w-auto mr-2"},t[9]||(t[9]=[e("option",{value:10},"10",-1),e("option",{value:25},"25",-1),e("option",{value:50},"50",-1),e("option",{value:100},"100",-1)]),512),[[Y,_.value,void 0,{number:!0}]]),t[11]||(t[11]=e("label",{class:"mb-0 text-sm text-muted mr-3"},"Entri",-1))]),e("div",me,[E(e("input",{"onUpdate:modelValue":t[1]||(t[1]=s=>g.value=s),type:"text",class:"form-control form-control-sm w-auto",style:{"min-width":"240px"},placeholder:"Cari NIK / Nama / Kontingen..."},null,512),[[q,g.value]]),e("button",{class:"btn btn-sm btn-outline-danger ml-2",disabled:!u.value||f.value,onClick:A,title:"Download PDF Daftar Kafilah"},t[12]||(t[12]=[e("i",{class:"fas fa-file-pdf mr-1"},null,-1),p(" Download PDF ")]),8,ge)])])]),e("div",_e,[e("table",fe,[t[17]||(t[17]=e("thead",{class:"thead-light"},[e("tr",null,[e("th",{style:{width:"50px"}},"#"),e("th",{style:{width:"180px"}},"NIK"),e("th",null,"Peserta"),e("th",null,"Cabang / Golongan"),e("th",{style:{width:"160px"}},"Kontingen"),e("th",{style:{width:"140px"},class:"text-center"},"Aksi")])],-1)),e("tbody",null,[f.value?(i(),r("tr",be,t[13]||(t[13]=[e("td",{colspan:"7",class:"text-center py-4"},"Memuat data peserta event...",-1)]))):h.value.length===0?(i(),r("tr",he,t[14]||(t[14]=[e("td",{colspan:"7",class:"text-center py-4"},[p(" Belum ada peserta terdaftar untuk event ini. "),e("br"),e("small",{class:"text-muted"},[p(" Klik "),e("strong",null,"Tambah Peserta Event"),p(" untuk menambahkan peserta. ")])],-1)]))):v("",!0),(i(!0),r(U,null,Q(h.value,(s,z)=>{var C,D,R;return i(),r("tr",{key:s.id},[e("td",xe,l(j(z)),1),e("td",null,[e("strong",null,l(((C=s.participant)==null?void 0:C.nik)||"-"),1),s.age_year!==null&&s.age_year!==void 0?(i(),r("div",ye)):v("",!0)]),e("td",null,[e("strong",null,l(((D=s.participant)==null?void 0:D.full_name)||"-"),1)]),e("td",null,[e("strong",null,l(((R=s.event_category)==null?void 0:R.full_name)||"-"),1),s.event_group?(i(),r("div",ke)):v("",!0)]),e("td",null,[e("span",we,l(s.contingent||"-"),1)]),e("td",Pe,[e("div",Ce,[e("button",{class:"btn btn-outline-primary btn-xs",title:"Lihat Data Peserta",onClick:O=>L(s)},t[15]||(t[15]=[e("i",{class:"fas fa-eye"},null,-1)]),8,De),I(s)?(i(),r("button",{key:0,class:"btn btn-outline-warning btn-xs",title:"Proses Daftar Ulang",onClick:O=>G(s)},t[16]||(t[16]=[e("i",{class:"fas fa-user-check"},null,-1)]),8,Re)):v("",!0)])])])}),128))])])]),e("div",Me,[e("div",Se,[e("div",Ee," Menampilkan "+l(n.value.from||0)+" - "+l(n.value.to||0)+" dari "+l(n.value.total||0)+" peserta event ",1),e("ul",Ue,[e("li",{class:K(["page-item",{disabled:n.value.current_page===1}])},[e("a",{href:"#",class:"page-link",onClick:t[2]||(t[2]=N(s=>k(n.value.current_page-1),["prevent"]))},"«")],2),e("li",$e,[e("span",Ke,"Halaman "+l(n.value.current_page)+" / "+l(n.value.last_page||1),1)]),e("li",{class:K(["page-item",{disabled:n.value.current_page===n.value.last_page}])},[e("a",{href:"#",class:"page-link",onClick:t[3]||(t[3]=N(s=>k(n.value.current_page+1),["prevent"]))},"»")],2)])])])])]),S(Z,{"selected-participant":x.value},null,8,["selected-participant"]),S(ee,{"event-participant":y.value,onUpdated:T},null,8,["event-participant"])])],64)}}},Te=te(Ne,[["__scopeId","data-v-40046e8b"]]);export{Te as default};
